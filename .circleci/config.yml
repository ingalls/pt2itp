version: 2
jobs:
    build:
        docker:
            - image: circleci/node:6.10.2
              environment:
                - PG_HOST=localhost
                - PG_USER=postgres
            - image: postgres:9.6
              environment:
                - POSTGRES_USER=ubuntu
                - POSTGRES_DB=pt_test
        working_directory: ~/repo
        steps:
            - checkout
            - run: apt-get install -y postgresql-client-9.6
            - run: yarn install
            - run: yarn run lint
            - run: yarn run doc
            - run: yarn run pretest
            - run: yarn run coverage
